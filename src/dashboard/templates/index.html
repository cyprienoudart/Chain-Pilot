<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChainPilot Dashboard</title>
    <link rel="stylesheet" href="/static/dashboard.css">
    <!-- Chart.js for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Minimal Header -->
        <header class="header">
            <div class="header-left">
                <h1>ChainPilot</h1>
                <div class="status-badge" id="networkStatus">
                    <span class="dot"></span>
                    <span id="networkName">Loading...</span>
                </div>
            </div>
            <div class="header-right">
                <div class="wallet-selector" id="walletSelector">
                    <select id="walletDropdown">
                        <option value="">No Wallet</option>
                    </select>
                </div>
            </div>
        </header>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Sidebar Navigation -->
            <nav class="sidebar">
                <button class="nav-btn active" data-view="overview">
                    <span class="icon">ðŸ“Š</span>
                    <span class="label">Overview</span>
                </button>
                <button class="nav-btn" data-view="transactions">
                    <span class="icon">ðŸ’¸</span>
                    <span class="label">Transactions</span>
                </button>
                <button class="nav-btn" data-view="ai">
                    <span class="icon">ðŸ¤–</span>
                    <span class="label">AI Chat</span>
                </button>
                <button class="nav-btn" data-view="rules">
                    <span class="icon">ðŸ”’</span>
                    <span class="label">Rules</span>
                </button>
            </nav>

            <!-- Content Area -->
            <main class="content">
                <!-- Overview View -->
                <div id="overview-view" class="view active">
                    <!-- Stats Row -->
                    <div class="stats-row">
                        <div class="stat-card">
                            <div class="stat-label">Balance</div>
                            <div class="stat-value" id="balanceValue">0.00 ETH</div>
                            <div class="stat-change">Sandbox Mode</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Transactions</div>
                            <div class="stat-value" id="txCountValue">0</div>
                            <div class="stat-change" id="txChange">All time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Active Rules</div>
                            <div class="stat-value" id="rulesCountValue">0</div>
                            <div class="stat-change">Enforced</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Network</div>
                            <div class="stat-value" id="networkValue">Sepolia</div>
                            <div class="stat-change" id="chainId">Chain ID: -</div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="charts-row">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Transaction Activity</h3>
                                <div class="chart-legend">Last 7 Days</div>
                            </div>
                            <div class="chart-container">
                                <canvas id="activityChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Transaction Types</h3>
                                <div class="chart-legend">Distribution</div>
                            </div>
                            <div class="chart-container">
                                <canvas id="typeChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="section-card">
                        <div class="section-header">
                            <h3>Recent Activity</h3>
                            <button class="btn-text" onclick="switchView('transactions')">View All â†’</button>
                        </div>
                        <div class="activity-list" id="recentActivity">
                            <div class="empty-message">No recent transactions</div>
                        </div>
                    </div>
                </div>

                <!-- Transactions View -->
                <div id="transactions-view" class="view">
                    <div class="view-header">
                        <h2>Transactions</h2>
                        <button class="btn-primary" onclick="openTransactionModal()">+ New</button>
                    </div>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Hash</th>
                                    <th>From</th>
                                    <th>To</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTableBody">
                                <tr>
                                    <td colspan="6" class="empty-message">No transactions</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- AI Chat View -->
                <div id="ai-view" class="view">
                    <div class="view-header">
                        <h2>AI Assistant</h2>
                        <button class="btn-text" onclick="clearChat()">Clear Chat</button>
                    </div>
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message bot">
                                <div class="message-content">
                                    <div class="message-text">
                                        <strong>ChainPilot AI</strong>
                                        <p>Try: "Send 0.01 ETH to 0x742d..." or "What's my balance?"</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="chat-input">
                            <input type="text" id="chatInput" placeholder="Ask me anything..." onkeypress="handleChatKeyPress(event)">
                            <button class="btn-primary" onclick="sendChat()">Send</button>
                        </div>
                    </div>
                </div>

                <!-- Rules View -->
                <div id="rules-view" class="view">
                    <div class="view-header">
                        <h2>Security Rules</h2>
                        <button class="btn-primary" onclick="openRuleModal()">+ New Rule</button>
                    </div>
                    <div class="rules-grid" id="rulesGrid">
                        <div class="empty-message">No rules configured</div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Transaction Modal -->
    <div id="txModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>New Transaction</h3>
                <button class="modal-close" onclick="closeModal('txModal')">&times;</button>
            </div>
            <form onsubmit="submitTransaction(event)">
                <div class="form-group">
                    <label>To Address</label>
                    <input type="text" id="txTo" placeholder="0x..." required>
                </div>
                <div class="form-group">
                    <label>Amount (ETH)</label>
                    <input type="number" id="txAmount" step="0.001" placeholder="0.5" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('txModal')">Cancel</button>
                    <button type="submit" class="btn-primary">Send</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Rule Modal -->
    <div id="ruleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Rule</h3>
                <button class="modal-close" onclick="closeModal('ruleModal')">&times;</button>
            </div>
            <form onsubmit="submitRule(event)">
                <div class="form-group">
                    <label>Rule Name</label>
                    <input type="text" id="ruleName" placeholder="Daily Limit" required>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select id="ruleType" required>
                        <option value="spending_limit">Spending Limit</option>
                        <option value="address_whitelist">Address Whitelist</option>
                        <option value="address_blacklist">Address Blacklist</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Action</label>
                    <select id="ruleAction" required>
                        <option value="deny">Deny</option>
                        <option value="require_approval">Require Approval</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('ruleModal')">Cancel</button>
                    <button type="submit" class="btn-primary">Create</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/dashboard.js"></script>
</body>
</html>
